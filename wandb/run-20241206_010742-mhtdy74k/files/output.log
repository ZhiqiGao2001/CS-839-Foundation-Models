  2%|████▏                                                                                                                                                                                                              | 90/4590 [00:24<20:05,  3.73it/s]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
{'loss': 10.7308, 'grad_norm': 3.3425912857055664, 'learning_rate': 4.9891067538126364e-05, 'epoch': 0.0}
{'loss': 10.5754, 'grad_norm': 1.6312830448150635, 'learning_rate': 4.9782135076252726e-05, 'epoch': 0.0}
{'loss': 10.491, 'grad_norm': 1.4620273113250732, 'learning_rate': 4.967320261437909e-05, 'epoch': 0.01}
{'loss': 10.4149, 'grad_norm': 1.5235164165496826, 'learning_rate': 4.956427015250545e-05, 'epoch': 0.01}
{'loss': 10.3236, 'grad_norm': 1.3140933513641357, 'learning_rate': 4.945533769063181e-05, 'epoch': 0.01}
{'loss': 10.2239, 'grad_norm': 1.8418992757797241, 'learning_rate': 4.9346405228758174e-05, 'epoch': 0.01}
{'loss': 10.1522, 'grad_norm': 2.561302423477173, 'learning_rate': 4.9237472766884536e-05, 'epoch': 0.02}
{'loss': 10.0602, 'grad_norm': 1.3620754480361938, 'learning_rate': 4.91285403050109e-05, 'epoch': 0.02}
{'loss': 10.0307, 'grad_norm': 1.248607873916626, 'learning_rate': 4.901960784313725e-05, 'epoch': 0.02}
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Traceback (most recent call last):
  File "/home/zhiqi/CS839-Project/small_model.py", line 114, in <module>
    initialize_training(
  File "/home/zhiqi/CS839-Project/small_model.py", line 89, in initialize_training
    trainer.train()
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/trainer.py", line 2123, in train
    return inner_training_loop(
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/trainer.py", line 2481, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/home/zhiqi/CS839-Project/dream_trainer.py", line 52, in training_step
    loss = self.dream_training_step(model, inputs)
  File "/home/zhiqi/CS839-Project/dream_trainer.py", line 79, in dream_training_step
    dream_inputs = self.prepare_dream_inputs(dream_data)
  File "/home/zhiqi/CS839-Project/dream_trainer.py", line 138, in prepare_dream_inputs
    input_ids = torch.cat([item['input_ids'] for item in dream_data], dim=0)
RuntimeError: Sizes of tensors must match except in dimension 0. Expected size 2048 but got size 49 for tensor number 5 in the list.
Traceback (most recent call last):
  File "/home/zhiqi/CS839-Project/small_model.py", line 114, in <module>
    initialize_training(
  File "/home/zhiqi/CS839-Project/small_model.py", line 89, in initialize_training
    trainer.train()
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/trainer.py", line 2123, in train
    return inner_training_loop(
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/trainer.py", line 2481, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/home/zhiqi/CS839-Project/dream_trainer.py", line 52, in training_step
    loss = self.dream_training_step(model, inputs)
  File "/home/zhiqi/CS839-Project/dream_trainer.py", line 79, in dream_training_step
    dream_inputs = self.prepare_dream_inputs(dream_data)
  File "/home/zhiqi/CS839-Project/dream_trainer.py", line 138, in prepare_dream_inputs
    input_ids = torch.cat([item['input_ids'] for item in dream_data], dim=0)
RuntimeError: Sizes of tensors must match except in dimension 0. Expected size 2048 but got size 49 for tensor number 5 in the list.
