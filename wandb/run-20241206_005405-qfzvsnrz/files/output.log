  0%|â–Š                                                                                                                                                                                                              | 176/45900 [00:47<3:23:15,  3.75it/s]Traceback (most recent call last):
{'loss': 10.7292, 'grad_norm': 3.5846221446990967, 'learning_rate': 4.9989106753812637e-05, 'epoch': 0.0}
{'loss': 10.5683, 'grad_norm': 1.6942174434661865, 'learning_rate': 4.997821350762528e-05, 'epoch': 0.0}
{'loss': 10.4911, 'grad_norm': 1.5195651054382324, 'learning_rate': 4.996732026143791e-05, 'epoch': 0.01}
{'loss': 10.3902, 'grad_norm': 1.522989273071289, 'learning_rate': 4.9956427015250546e-05, 'epoch': 0.01}
{'loss': 10.2892, 'grad_norm': 1.4010010957717896, 'learning_rate': 4.994553376906319e-05, 'epoch': 0.01}
{'loss': 10.1732, 'grad_norm': 1.9333806037902832, 'learning_rate': 4.993464052287582e-05, 'epoch': 0.01}
{'loss': 10.105, 'grad_norm': 3.82442045211792, 'learning_rate': 4.9923747276688455e-05, 'epoch': 0.02}
{'loss': 10.0102, 'grad_norm': 1.3189244270324707, 'learning_rate': 4.9912854030501096e-05, 'epoch': 0.02}
{'loss': 9.9783, 'grad_norm': 1.244471549987793, 'learning_rate': 4.990196078431373e-05, 'epoch': 0.02}
{'loss': 9.817, 'grad_norm': 1.5366369485855103, 'learning_rate': 4.9891067538126364e-05, 'epoch': 0.02}
{'loss': 9.7858, 'grad_norm': 1.3714884519577026, 'learning_rate': 4.9880174291939005e-05, 'epoch': 0.02}
{'loss': 9.6913, 'grad_norm': 1.869594931602478, 'learning_rate': 4.986928104575164e-05, 'epoch': 0.03}
{'loss': 9.6353, 'grad_norm': 1.6009851694107056, 'learning_rate': 4.9858387799564274e-05, 'epoch': 0.03}
{'loss': 9.5137, 'grad_norm': 1.4151804447174072, 'learning_rate': 4.984749455337691e-05, 'epoch': 0.03}
{'loss': 9.512, 'grad_norm': 1.2783657312393188, 'learning_rate': 4.983660130718955e-05, 'epoch': 0.03}
{'loss': 9.4354, 'grad_norm': 1.3466284275054932, 'learning_rate': 4.982570806100218e-05, 'epoch': 0.03}
{'loss': 9.3796, 'grad_norm': 1.4216210842132568, 'learning_rate': 4.981481481481482e-05, 'epoch': 0.04}
  File "/home/zhiqi/CS839-Project/small_model.py", line 113, in <module>
  File "/home/zhiqi/CS839-Project/small_model.py", line 90, in initialize_training
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/trainer.py", line 2123, in train
    return inner_training_loop(
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/trainer.py", line 2481, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/home/zhiqi/CS839-Project/dream_trainer.py", line 64, in training_step
    loss = super().training_step(model, inputs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/trainer.py", line 3579, in training_step
    loss = self.compute_loss(model, inputs, num_items_in_batch=num_items_in_batch)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/trainer.py", line 3633, in compute_loss
    outputs = model(**inputs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py", line 968, in forward
    transformer_outputs = self.transformer(
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py", line 750, in forward
    outputs = block(
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py", line 459, in forward
    attn_outputs = self.attn(
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py", line 409, in forward
    return self.attention(
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py", line 261, in forward
    attn_output, attn_weights = self._attn(query, key, value, attention_mask, head_mask)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py", line 220, in _attn
    mask_value = torch.tensor(mask_value, dtype=attn_weights.dtype).to(attn_weights.device)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/zhiqi/CS839-Project/small_model.py", line 113, in <module>
  File "/home/zhiqi/CS839-Project/small_model.py", line 90, in initialize_training
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/trainer.py", line 2123, in train
    return inner_training_loop(
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/trainer.py", line 2481, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/home/zhiqi/CS839-Project/dream_trainer.py", line 64, in training_step
    loss = super().training_step(model, inputs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/trainer.py", line 3579, in training_step
    loss = self.compute_loss(model, inputs, num_items_in_batch=num_items_in_batch)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/trainer.py", line 3633, in compute_loss
    outputs = model(**inputs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py", line 968, in forward
    transformer_outputs = self.transformer(
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py", line 750, in forward
    outputs = block(
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py", line 459, in forward
    attn_outputs = self.attn(
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py", line 409, in forward
    return self.attention(
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py", line 261, in forward
    attn_output, attn_weights = self._attn(query, key, value, attention_mask, head_mask)
  File "/home/zhiqi/anaconda3/envs/llmmath/lib/python3.10/site-packages/transformers/models/gpt_neo/modeling_gpt_neo.py", line 220, in _attn
    mask_value = torch.tensor(mask_value, dtype=attn_weights.dtype).to(attn_weights.device)
KeyboardInterrupt
